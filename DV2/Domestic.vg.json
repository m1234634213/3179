{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 600,
  "title": "Australian Domestic Flight Routes (Passenger Weighted)",
  "projection": {
    "type": "mercator",
    "center": [133, -27],
    "scale": 800
  },
  "params": [
    {
      "name": "year_selector",
      "value": 2000,
      "bind": {
        "input": "select",
        "options": [
          2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,
          2010,2011,2012,2013,2014,2015,2016,2017,2018,2019
        ],
        "name": "Year: "
      }
    }
  ],
  "layer": [
    {
      "data": {
        "url": "ne_110m_admin_0_australia.topojson",
        "format": {
          "type": "topojson",
          "feature": "ne_110m_admin_0_australia"
        }
      },
      "mark": {"type": "geoshape","fill": "#f0f0f0","stroke": "#888"}
    },
    {
      "data": {"url": "Domestic Flights.csv"},
      "transform": [
        {"filter": "datum.Year == year_selector"},
        {
          "aggregate": [
            {"op": "sum", "field": "Passenger_Trips", "as": "Passenger_Trips"}
          ],
          "groupby": [
            "City1","City1_Lon","City1_Lat",
            "City2","City2_Lon","City2_Lat"
          ]
        }
      ],
      "mark": {"type": "rule","stroke": "steelblue","strokeOpacity": 0.5},
      "encoding": {
        "longitude": {"field": "City1_Lon","type": "quantitative"},
        "latitude": {"field": "City1_Lat","type": "quantitative"},
        "longitude2": {"field": "City2_Lon"},
        "latitude2": {"field": "City2_Lat"},
        "strokeWidth": {
          "field": "Passenger_Trips",
          "type": "quantitative",
          "scale": {"range": [2,12]}
        },
        "tooltip": [
          {"field": "City1","type":"nominal","title":"Origin"},
          {"field": "City2","type":"nominal","title":"Destination"},
          {"field": "Passenger_Trips","type":"quantitative","title":"Passengers"}
        ]
      }
    },
    {
      "data": {"url": "Domestic Flights.csv"},
      "transform": [{"filter": "datum.Year == year_selector"}],
      "mark": {"type": "circle","size": 40,"color": "red"},
      "encoding": {
        "longitude": {"field": "City1_Lon","type": "quantitative"},
        "latitude": {"field": "City1_Lat","type": "quantitative"},
        "tooltip": {"field": "City1","type": "nominal","title":"Origin Airport"}
      }
    },
    {
      "data": {"url": "Domestic Flights.csv"},
      "transform": [{"filter": "datum.Year == year_selector"}],
      "mark": {"type": "circle","size": 40,"color": "red"},
      "encoding": {
        "longitude": {"field": "City2_Lon","type": "quantitative"},
        "latitude": {"field": "City2_Lat","type": "quantitative"},
        "tooltip": {"field": "City2","type": "nominal","title":"Destination Airport"}
      }
    }
  ]
}
