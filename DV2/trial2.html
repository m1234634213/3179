<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Visualisation 2</title>
  <link rel="stylesheet" href="trial.css">
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>

<body>
  <header>
    <h1>Data Visualisation 2</h1>
    <div class="cloud cloud1">
      <div class="light"></div>
      <img src="05cd33059a006bf49006097af4ccba98-plane-in-flight-by-vexels.png" alt="Plane" />
    </div>
  </header>

  <div id="sliderContainer">
    <label for="yearSlider"><strong>Select Year:</strong></label>
    <input type="range" id="yearSlider" min="2000" max="2025" step="1" value="2010">
    <span id="yearLabel">2010</span>
  </div>

  <main class="dashboard">

    <!-- Row 1 -->
    <div class="row">
      <div class="story-box">
        <h2>Global Flight Trends</h2>
        <p>The global aviation network shows how Australia connects with major cities worldwide. Key hubs dominate traffic, while new routes emerge over time.</p>
      </div>
      <div class="chart-box main-chart">
        <div id="mainChart"></div>
      </div>
    </div>

    <!-- Row 2 -->
    <div class="row">
      <div class="chart-box">
        <h2>Domestic Airlines</h2>
        <div id="domesticAirlines"></div>
      </div>
      <div class="story-box">
        <h2>Competition in the Skies</h2>
        <p>Domestic airlines in Australia have evolved, with Qantas and Virgin dominating. Smaller airlines like Skywest disappeared, while newcomers like Bonza entered the market.</p>
      </div>
    </div>

    <!-- Row 3 -->
    <div class="row">
      <div class="story-box">
        <h2>Passenger Movements</h2>
        <p>Domestic passenger patterns reveal how Australia’s internal travel network adjusts to economic and social shifts — from mining booms to pandemic recovery.</p>
      </div>
      <div class="chart-box">
        <div id="domestic"></div>
      </div>
    </div>

    <!-- Row 4 -->
    <div class="row">
      <div class="chart-box">
        <h2>International Routes</h2>
        <div id="cityInt"></div>
      </div>
      <div class="story-box">
        <h2>Expanding Horizons</h2>
        <p>Australia’s international connections have grown towards Asia and the Middle East, while long-haul routes to Europe and North America remain vital for tourism and trade.</p>
      </div>
    </div>

    <!-- Row 5 -->
    <div class="row">
      <div class="story-box">
        <h2>Environmental Impact</h2>
        <p>The emissions map highlights aviation’s growing responsibility in global climate targets. It visualizes the CO₂ intensity of major routes across decades.</p>
      </div>
      <div class="chart-box">
        <h2>Emissions Map</h2>
        <div id="emissionsMap"></div>
      </div>
    </div>

    <!-- Row 6 -->
    <div class="row">
      <div class="chart-box">
        <h2>Fuel & Gas Trends</h2>
        <div id="gas"></div>
      </div>
      <div class="story-box">
        <h2>Energy Efficiency Over Time</h2>
        <p>Fuel usage reveals both the environmental and economic side of aviation. Efficiency gains offset some emissions growth, but total output keeps climbing.</p>
      </div>
    </div>

    <!-- Row 7 -->
    <div class="row">
      <div class="story-box">
        <h2>Interactive Globe</h2>
        <p>This rotating 3D globe offers a live view of flight paths evolving over time — a compelling visual to explore the world’s interconnected skies.</p>
      </div>
      <div class="chart-box main-chart">
        <div id="week9Homework" class="rotating-globe"></div>
      </div>
    </div>

  </main>

  <script>
    const charts = [
      { id: "mainChart", file: "world_map.vg.json" },
      { id: "domesticAirlines", file: "domestic_airlines.vg.json" },
      { id: "domestic", file: "Domestic.vg.json" },
      { id: "emissionsMap", file: "Emissions_map.vg.json" },
      { id: "cityInt", file: "city_int.vg.json" },
      { id: "gas", file: "gas.vg.json" },
      { id: "week9Homework", file: "week_9_homework.vg.json" },
    ];

    let chartViews = {};
    const yearSlider = document.getElementById("yearSlider");
    const yearLabel = document.getElementById("yearLabel");

    function updateCharts(year) {
      yearLabel.textContent = year;
      Object.values(chartViews).forEach(view => {
        view.signal("selectedYear", year).run();
      });
    }

    charts.forEach(chart => {
      fetch(chart.file)
        .then(r => r.json())
        .then(spec => {
          spec.params = spec.params || [];
          spec.params.push({ name: "selectedYear", value: parseInt(yearSlider.value), bind: false });
          vegaEmbed('#' + chart.id, spec, { actions: false }).then(res => {
            chartViews[chart.id] = res.view;
          });
        });
    });

    yearSlider.addEventListener("input", e => updateCharts(parseInt(e.target.value)));

    let globeView;
    vegaEmbed('#week9Homework', 'week_9_homework.vg.json', { actions: false })
      .then(res => {
        globeView = res.view;
        let angle = 0;
        const rotationSpeed = 0.2;
        setInterval(() => {
          angle += rotationSpeed;
          globeView.signal("rotate0", angle).run();
        }, 50);
      });
  </script>
</body>
</html>
