<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Visualisation 2</title>
  <link rel="stylesheet" href="trial.css">
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>

<body>
  <header>
    <h1>Data Visualisation 2</h1>
    <div class="cloud cloud1">
      <div class="light"></div>
      <img src="05cd33059a006bf49006097af4ccba98-plane-in-flight-by-vexels.png" alt="Plane" />
    </div>
  </header>

  <!-- Year slider -->
  <div id="sliderContainer">
    <label for="yearSlider"><strong>Select Year:</strong></label>
    <input type="range" id="yearSlider" min="2000" max="2025" step="1" value="2010">
    <span id="yearLabel">2010</span>
  </div>

  <main class="dashboard">
    <!-- Row 1 -->
    <div class="row">
      <div class="story-box">
        <h2>Global Flight Trends</h2>
        <p>The global aviation network shows how Australia connects with major cities worldwide. Major hubs dominate
          traffic, while new routes emerge over time. The visual highlights the dynamic shifts in international
          connectivity and the growing importance of Asia-Pacific routes.</p>
      </div>
      <div class="chart-box main-chart">
        <div id="mainChart"></div>
      </div>
    </div>

    <!-- Row 2 -->
    <div class="row">
      <div class="chart-box">
        <h2>Domestic Airlines</h2>
        <div id="domesticAirlines"></div>
      </div>
      <div class="story-box">
        <h2>Evolution of Domestic Airlines</h2>
        <p>Qantas and Virgin Australia continue to dominate the domestic market. Over the years, smaller carriers like
          Skywest disappeared due to strong competition, while new players such as Bonza have recently entered to shake
          up the landscape.</p>
      </div>
    </div>

    <!-- Row 3 -->
    <div class="row">
      <div class="story-box">
        <h2>Domestic Passenger Patterns</h2>
        <p>Domestic passenger numbers reflect internal travel demands. Spikes coincide with holiday periods and major
          events, while declines mark economic downturns and border restrictions during global disruptions.</p>
      </div>
      <div class="chart-box full-width">
        <h2>Passenger Trends</h2>
        <div id="domestic"></div>
      </div>
    </div>

    <!-- Row 4 -->
    <div class="row">
      <div class="story-box">
        <h2>International Routes</h2>
        <p>Australia’s outbound and inbound connections have evolved, reflecting tourism, business, and migration
          trends. Growing links to Asia highlight the region’s rising economic importance and travel demand.</p>
      </div>
      <div class="chart-box">
        <div id="cityInt"></div>
      </div>
    </div>

    <!-- Row 5 -->
    <div class="row">
      <div class="chart-box">
        <h2>Emissions Impact</h2>
        <div id="emissionsMap"></div>
      </div>
      <div class="story-box">
        <h2>Environmental Impact</h2>
        <p>The emissions map reveals the environmental footprint of air routes. Longer international flights
          disproportionately affect total emissions, driving the need for fuel-efficient technologies and sustainable
          aviation policies.</p>
      </div>
    </div>

    <!-- Row 6 -->
    <div class="row">
      <div class="story-box">
        <h2>Energy and Fuel Trends</h2>
        <p>Fluctuations in jet fuel and gas prices directly influence airline ticket costs and operational decisions.
          Energy trends are pivotal in shaping the sustainability and pricing of air travel.</p>
      </div>
      <div class="chart-box full-width">
        <h2>Gas Trends</h2>
        <div id="gas"></div>
      </div>
    </div>

    <!-- Row 7 -->
    <div class="row">
      <div class="story-box">
        <h2>Rotating Globe Visualisation</h2>
        <p>This rotating 3D globe visualises aviation pathways, revealing how geography and distance influence air
          connectivity. It captures the beauty and complexity of global travel networks in motion.</p>
      </div>
      <div class="chart-box main-chart">
        <div id="week9Homework" class="rotating-globe"></div>
      </div>
    </div>
  </main>

  <script>
    const charts = [
      { id: "mainChart", file: "world_map.vg.json" },
      { id: "domesticAirlines", file: "domestic_airlines.vg.json" },
      { id: "domestic", file: "Domestic.vg.json" },
      { id: "emissionsMap", file: "Emissions_map.vg.json" },
      { id: "cityInt", file: "city_int.vg.json" },
      { id: "gas", file: "gas.vg.json" },
      { id: "week9Homework", file: "week_9_homework.vg.json" },
    ];

    let chartViews = {};
    const yearSlider = document.getElementById("yearSlider");
    const yearLabel = document.getElementById("yearLabel");

    function updateCharts(year) {
      yearLabel.textContent = year;
      Object.values(chartViews).forEach(view => {
        view.signal("selectedYear", year).run();
      });
    }

    charts.forEach(chart => {
      fetch(chart.file)
        .then(r => r.json())
        .then(spec => {
          spec.params = spec.params || [];
          spec.params.push({ name: "selectedYear", value: parseInt(yearSlider.value), bind: false });
          vegaEmbed('#' + chart.id, spec, { actions: false }).then(res => {
            chartViews[chart.id] = res.view;
          });
        });
    });

    yearSlider.addEventListener("input", e => updateCharts(parseInt(e.target.value)));

    let globeView;
    vegaEmbed('#week9Homework', 'week_9_homework.vg.json', { actions: false })
      .then(res => {
        globeView = res.view;
        let angle = 0;
        const rotationSpeed = 0.2;
        setInterval(() => {
          angle += rotationSpeed;
          globeView.signal("rotate0", angle).run();
        }, 50);
      });
  </script>
</body>

</html>
